# 并发模型和事件循环

## 运行时的概念 (Runtime)

* 栈
函数调用形成一个栈(堆栈帧), 当函数调用完毕, 栈会被清空
* 堆
对象的内存分配在堆中
* 队列
JS运行时包含一个待处理的消息队列, 每个消息都与一个函数相关联.

## 事件循环 (Event loop)

* 事件循环的方式类似于从消息队列中循环获取消息并处理, 当没有消息时会同步等待直到消息到来
    - 消息会执行到完毕后, 再执行下一条消息. 不会中途切换
    - 多个运行时通信: 每个web worker或跨域iframe都有自己的栈, 堆和消息队列, 不同的运行时需要通过`postMessage`方法通信
* 事件模型不会阻塞

```javascript
// 事件循环的伪代码
while(queue.waitForMessage()){
    queue.processNextMessage();
}
```

