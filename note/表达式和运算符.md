# 表达式和运算符

包括赋值, 比较, 算数, 位运算, 逻辑, 字符串, 三元运算

## 运算符 (Operator)

分类如下
* 赋值运算符
* 比较运算符
* 算术运算符
* 位运算符
* 逻辑运算符
* 字符串运算符
* 条件(三元)运算符
* 逗号运算符
* 一元运算符
* 关系运算符

* 一元运算符 (unary)
    - 需要一个操作数
    - `操作数1 运算符`或`运算符 操作数1`
    - 例如: `x++`或`++x`或`-x`(负数)或`+'3'`(非Number转Number)
* 二元运算符 (binary)
    - 需要两个操作数
    - `操作数1 运算符 操作数2`
    _ 例如: `a + b`
* 三元运算符 (ternary)
    - 操作三个运算符
    - `操作数1 操作符 操作数2 操作符 操作数3`
    - 例如: `a === b ? 1 : 2`

### 赋值运算符

* 将操作符右侧的操作数的值赋给左侧的操作数

| 表达式      | 等同于         | 含义                                         |
|------------|---------------|---------------------------------------------|
| `x = y`    | `x = y`       | 赋值 assignment                              |
| `x += y`   | `x = x + y`   | 加法赋值 addition assignment                  |
| `x -= y`   | `x = x - y`   | 减法赋值 subtraction assignment               |
| `x *= y`   | `x = x * y`   | 乘法赋值 multiplication assignment            |
| `x /= y`   | `x = x / y`   | 除法赋值 division assignment                  |
| `x %= y`   | `x = x % y`   | 求余赋值 remainder assignment                 |
| `x **= y`  | `x = x ** y`  | 求幂赋值 exponentiation assignment            |
| `x <<= y`  | `x = x << y`  | 左移位赋值 left shift assignment              |
| `x >>= y`  | `x = x >> y`  | 右移位赋值 right shift assignment             |
| `x >>>= y` | `x = x >>> y` | 无符号右移赋值 unsigned right shift assignment |
| `x &= y`   | `x = x & y`   | 按位与赋值 bitwise AND assignment             |
| `x ^= y`   | `x = x ^ y`   | 按位异或赋值 bitwise XOR assignment           |
| `x |= y`   | `x = x | y`   | 按位或赋值 bitwise OR assignment              |

### 解构 destructuring

从 *数组* 或 *对象对应于的数组解构* 或 *对象字面量* 里提取数据的JS表达式

```javascript
// 创建一个数组
var foo = ["one", "two", "three"];

// 不使用解构
var one = foo[0];
var two = foo[1];
var three = foo[2];

// 使用解构
var [one, two, three] = foo;
```

## 比较运算符

* 比较操作数, 返回是否为真
* 操作数可以是`数字`, `字符串`, `逻辑`, `对象值`
* 字符串比较基于标准的字典顺序, 使用Unicode值
* 多数情况下, 如果两个操作数不是相同的类型, JS会尝试转换他们为恰当的类型来比较, 通常发生在数字作为操作数的比较
* 严格相等`===`和严格不等`!==`不会检查操作数的类型
* **注意:** `=>`不是运算符, 而是箭头函数的标识符

| 运算符 | 含义          | 解释                               |
|-------|--------------|------------------------------------|
| `==`  | 相等          | 两边操作数相等为true                 |
| `!=`  | 不等          | 两个操作数不等为true                 |
| `===` | 严格相等(全等)  | 两边操作数相等 **且** 类型相同为true  |
| `!==` | 严格不等(不全等)| 两边操作数不等 **或** 类型不同为true   |
| `>`   | 大于          | 左边操作数大于右边操作数为true         |
| `>=`  | 大于等于       | 左边的操作数大于或等于右边的操作数为true |
| `<`   | 小于          | 左边的操作数小于右边的操作数为true      |
| `<=`  | 小于等于       | 左边的操作数小于或等于右边的操作数为true |

```javascript
// 各种情况的比较结果
var var1 = 3;
var var2 = 4;
// 相等: ==
console.log(3   == var1); // true
console.log("3" == var1); // true, 字符串转换为数字后比较
console.log(3   == '3');  // true, 字符串转换为数字后比较

// 不等: !=
console.log(var1 != 4);   // true
console.log(var2 != "3"); // true, 字符串转换为数字后比较

// 严格相等: ===
console.log(3 === var1); // true, 值相同, 类型相同

// 严格不等
console.log(var1 !== "3"); // true, 值相同, 但类型不同
console.log(3    !== '3'); // true, 值相同, 但类型不同

// 大于: >
console.log(var2 > var1); // true
console.log("12" > 2);    // true, 字符串转换为数字后比较

// 大于等于: >=
console.log(var2 >= var1); // true
console.log(var1 >= 3);    // true

// 小于: <
console.log(var1 < var2); // true
console.log("2"  < 12);   // true, 字符串转换为数字后比较

// 小于等于: <=
console.log(var1 <= var2); // true
console.log(var2 <= 5);    // true
```

## 算术运算符

* 使用数值(字面量或者变量)作为操作数, 并返回一个数值
* 除0会得到`Infinity` (与其他语言抛出异常不同)

| 运算符 | 含义                                   | 示例 |
|-------|----------------------------------------|-----------|
| `%`   | 求余. 二元运算符. 返回相除之后的余数        | 13 % 5 = 3 |
| `++`  | 自增. 一元运算符. 将操作数的值加一| ++x先自增1后返回值; x++先返回值后自增1|
| `--`  | 自减. 一元运算符. 将操作数的值减一| --x先自减1后返回值; x--先返回值后自减1|
| `-`   | 负. 一元运算符. 返回操作数的负值            | -x |
| `+`   | 一元运算符. 将不是Number的操作数转换为Number| +'3'|

```javascript
// 整数相除
console.log(1 / 2);     // 0.5
// 浮点数相除
console.log(1.0 / 2.0); // 0.5
// 整数移除浮点数
console.log(1 / 2.0);   // 0.5
// 浮点数除以整数
console.log(1.0 / 2);   // 0.5
// 整数除0
console.log(1 / 0);     // Infinity
// 浮点数除0
console.log(1.0 / 0);   // Infinity
```

## 位运算符 (bitwise operator)

* 将操作数视为32位元的二进制串(0和1组成), 在该二进制上执行运算, 但是返回的结果是JS数值类型
* 操作数被转换为32位整数, 以位序列(0和1)表示. 如果超出32位, 则取低32位

| 操作符 | 名称    | 示例      | 含义                           |
|-------|---------|---------|--------------------------------|
| `&`   | 按位与   | `a & b` | a与b的对应位都为1则返回1, 否则返回0|
| `|`   | 按位或   | `a | b` | a与b的对应位只要有一个为1则返回1, 否则返回0|
| `^`   | 按位异或 | `a ^ b` | a与b对应的位如果不相同则返回1, 相同则返回0|
| `~`   | 按位非   | `~a`    | 翻转操作数的位, 0变1, 1变0 |
| `<<`  | 左移    | `a << b` | 把a的二进制向左移动b位, 左侧超出丢弃, 右侧空缺用0补全|
| `>>`  | 算数右移 | `a >> b` | 把a的二进制向右移动b位, 右侧超出丢弃, 左侧空缺是正数则用0补充, 是负数则用1补充 |
| `>>>` | 无符号右移 | `a >>> b` | 把a二进制向右移动b为, 右侧超出丢弃, 左侧空缺都填充为0|

```javascript
// 1111 & 1001 = 1001
console.log(15 & 9); // 9

// 1111 | 1001 = 1111
console.log(15 | 9); // 15

// 1111 ^ 1001 = 0110
console.log(15 ^ 9); //6

// ~0000...00001111 = 1111...11110000
console.log(~15); // -16

// ~0000...00001001 = 1111...11110110
console.log(~9); // -10

// 1001 << 2 = 100100
console.log(9 << 2); // 36

// 1001 >> 2 = 10
console.log(9 >> 2); // 2

// 10000000 00000000 00000000 00001001 >> 2 = 11100000 00000000 00000000 00000010
console.log(-9 >> 2); // -3

// 10011 >> 2 = 100
console.log(19 >>> 2); // 4
```

## 逻辑运算符 (logical operator)

* 可转换为`false`的值
    - `null`
    - `0`
    - `NaN`
    - `""`空字符串
    - `undefined`

| 运算符 | 名称  | 示例    | 含义                                      |
|-------|-------|---------|-----------------------------------------|
| `&&`  | 逻辑与 | a && b | 如果前者能转换为false, 则返回前者; 否则返回后者|
| `||`  | 逻辑或 | a || b | 如果前者能转换为true, 则返回前者; 否则返回后者 |
| `!`   | 逻辑非 | !a     | 取反值                                    |

```javascript
// &&
console.log(true && true); // true
console.log(true && false); // false
console.log(false && true); // false
console.log(false && (3 == 4)); // false
console.log("cat" && "dog"); // dog
console.log(false && "cat"); // false
console.log("cat" && false); // false

// ||
console.log(true || true); // true
console.log(true || false); // true
console.log(false || true); // true
console.log(false || (3 == 4)); // false
console.log("cat" || "dog"); // cat
console.log(false || "cat"); // cat
console.log("cat" || false); // cat

// !
console.log(!true); // false
console.log(!false); // true
console.log(!"cat"); // false
```
